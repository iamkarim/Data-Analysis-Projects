# Advanced SQL and Databases 

This repository includes the solutions to the Sprint 4 projects which are located in this [worksheet](https://docs.google.com/spreadsheets/d/1vHK_7k8LFH6IhslKJS5u68IH6Eaax4-PLSx3nwDThE0/edit?usp=sharing)

- Task 1.1 highlights using the `CASE` clause creating the addressing_title and in the AddressLine2. The query also utilises a subquery to get the max AddressID
- Task 1.2 utilises Task 1.1 as a CTE and merges it to get Active customers
- Task 1.3 utilises Task 1.2 as a CTE to get Active and Inactive Customers in a column
- Task 1.4 filters Task 1.3 to get the active customers and North American customers that have ordered more than 5 items or spent more than 2500

- Task 2.1 highlights the DATETIME and Aggregate functions.
- Task 2.2 highlights using a CTE and Window functions
- Task 2.3 uses Task 2.2 as a CTE and a RANK() in the Window functions
- Task 2.4 utilises a lot of CTEs getting the tax rates and the number of provinces in each Country
